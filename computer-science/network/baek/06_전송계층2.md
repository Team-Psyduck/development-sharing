# 전송계층 2

## TCP의 특징

TCP는 point To point 통신을 완장한다. 

소켓 한 쌍의 통신을 책임진다. 

하나도 유실되지 않고 순서대로 전송된다.

데이터가 양방향으로 진행된다. 

데이터를 받는 곳이 데이터를 받을 수 있는 만큼만 전송한다.(flow controlled)

Cumulative ACK (ACK 10번을 전송하면 Go-Back_N에서는 10번까지 잘 받았어지만, TCP는 9번까지 잘 받았어 10번 보내줘 라는 의미)

## OSI 계층의 전송 단위

용용계층의 전송 단위 : 메세지(http request, response…)

소켓을 통해 tcp 계층으로 전송

TCP 전송 단위 : 세그먼트   (TCP헤더 + 데이터) 

네트워크 전송 단위 : 패킷 (IP 헤더 + 세그먼트)

링크 레이어 전송 단위 : 프레임 (헤더 + 패킷)

## time out 시간 설정

Round Trip Time 줄여서 RTT 는 우리말로 하면 **왕복 시간**
이란 의미로 인터넷 상에서 송신지부터 목적지까지 패킷이 왕복하는데 걸리는 시간을 뜻한다.

그러면 time out 시간을 RTT로 설정해도 괜찮은가?

1. 동일한 라우터를 통해서 데이터가 전송된다 하더라도 큐잉 딜레이 때문에  RTT가 천차만별이다. 

그래서 RTT시간의 평균을 낸값 EntimatedRTT  + 4 * DevRTT 값이다. 

## TCP reliable data transfer

1. 파이프라인 방식이다. 
2. TCP Ack는 Cumulative acks 이다.
3. TCP는 타임아웃을 하나 사용하지만, go-back-n과 다르게 해당 타임아웃난 세그먼트만 재전송한다. 

## fast retransmit

sender가 1~100번 세그먼트를 전송할때

9번까지 잘 받았다면, 10번을 요청한다. 하지만, 10번은 유실되었고, 그렇게 3번정도 더 요청을 하게되면, 유실이 되었다고 판단하여 재전송을 해주는 방식이다. 기존 타이머 방식보다 더 효율적인 이유는 RTT + 알파의 시간을 데이터 유실 판단 시간인데 이시간보다 3번 더 요청했을때 데이터가 안왔다면, 재전송 받는게 더 빠르기 때문이다. 

하지만, 타이머는 필수지만, fast retransmit은 좀더 빠르게 해주는 최적화 방식이다.
